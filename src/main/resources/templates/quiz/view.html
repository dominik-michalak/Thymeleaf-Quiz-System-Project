<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="${quiz.title + ' - Quiz App'}">Quiz View</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" th:href="@{/}"><strong>Quiz App</strong></a>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item"><a class="nav-link" th:href="@{/}">Home</a></li>
                    <li class="nav-item"><a class="nav-link" th:href="@{/quizzes}">All Quizzes</a></li>
                    <li class="nav-item"><a class="nav-link" th:href="@{/quiz/create}">Create Quiz</a></li>
                </ul>
            </div>
        </div>
    </nav>
    <div class="container mt-4">
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a th:href="@{/}">Home</a></li>
                <li class="breadcrumb-item"><a th:href="@{/quizzes}">Quizzes</a></li>
                <li class="breadcrumb-item active" th:text="${quiz.title}">Quiz</li>
            </ol>
        </nav>
        <div class="card mb-4">
            <div class="card-header bg-primary text-white">
                <h2 class="mb-0" th:text="${quiz.title}">Quiz Title</h2>
            </div>
            <div class="card-body">
                <p class="lead" th:text="${quiz.description != null ? quiz.description : 'No description'}">Description</p>
                <hr>
                <div class="row">
                    <div class="col-md-4">
                        <strong>Category:</strong>
                        <span class="badge bg-secondary" th:text="${quiz.category != null ? quiz.category : 'General'}">Category</span>
                    </div>
                    <div class="col-md-4">
                        <strong>Questions:</strong> <span th:text="${#lists.size(questions)}">0</span>
                    </div>
                    <div class="col-md-4">
                        <strong>Max Score:</strong> <span th:text="${quiz.calculateTotalScore()}">0</span> points
                    </div>
                </div>
            </div>
            <div class="card-footer">
                <a th:href="@{/quiz/{id}/take(id=${quiz.id})}" class="btn btn-success btn-lg me-2">Take This Quiz</a>
                <a th:href="@{/quiz/{id}/edit(id=${quiz.id})}" class="btn btn-warning me-2">Edit Quiz</a>
                <a th:href="@{/quizzes}" class="btn btn-outline-secondary">Back to List</a>
            </div>
        </div>
        <h4>Questions Preview</h4>
        <div th:if="${#lists.isEmpty(questions)}" class="alert alert-info">
            No questions in this quiz yet. <a th:href="@{/quiz/{id}/edit(id=${quiz.id})}">Add some questions!</a>
        </div>
        <div class="accordion" id="questionsAccordion" th:unless="${#lists.isEmpty(questions)}">
            <div class="accordion-item" th:each="question, stat : ${questions}">
                <h2 class="accordion-header">
                    <button class="accordion-button collapsed" type="button"
                            th:attr="data-bs-target='#collapse' + ${stat.index}"
                            data-bs-toggle="collapse">
                        <span class="badge bg-primary me-2" th:text="${stat.count}">1</span>
                        <span th:text="${question.questionText}">Question text</span>
                        <span class="badge bg-success ms-auto me-2" th:text="${question.score + ' pts'}">10 pts</span>
                    </button>
                </h2>
                <div th:id="'collapse' + ${stat.index}" class="accordion-collapse collapse"
                     data-bs-parent="#questionsAccordion">
                    <div class="accordion-body">
                        <p><strong>Category:</strong> <span th:text="${question.category}">Category</span></p>
                        <p><strong>Options:</strong></p>
                        <ul class="list-group">
                            <li class="list-group-item" th:if="${question.optionA != null}">
                                <strong>A:</strong> <span th:text="${question.optionA}">Option A</span>
                            </li>
                            <li class="list-group-item" th:if="${question.optionB != null}">
                                <strong>B:</strong> <span th:text="${question.optionB}">Option B</span>
                            </li>
                            <li class="list-group-item" th:if="${question.optionC != null}">
                                <strong>C:</strong> <span th:text="${question.optionC}">Option C</span>
                            </li>
                            <li class="list-group-item" th:if="${question.optionD != null}">
                                <strong>D:</strong> <span th:text="${question.optionD}">Option D</span>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
